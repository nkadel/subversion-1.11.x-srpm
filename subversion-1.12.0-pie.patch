
Link executables using -pie, link test executables using -no-install.

diff -uap subversion-1.12.0.pie/build.conf subversion-1.12.0/build.conf
--- subversion-1.12.0/build.conf.pie	2019-01-16 10:58:30.000000000 -0500
+++ subversion-1.12.0/build.conf	2019-05-03 13:56:54.059076661 -0400
@@ -572,7 +572,7 @@ lang = python
 path = subversion/bindings/swig/python/libsvn_swig_py
 libs = libsvn_client libsvn_wc libsvn_ra libsvn_delta libsvn_subr
        apriconv apr python swig
-link-cmd = $(LINK)
+link-cmd = $(LINK_LIB)
 install = swig-py-lib
 # need special build rule to include -DSWIGPYTHON
 compile-cmd = $(COMPILE_SWIG_PY)
@@ -598,7 +598,7 @@ type = swig_lib
 lang = ruby
 path = subversion/bindings/swig/ruby/libsvn_swig_ruby
 libs = libsvn_client libsvn_wc libsvn_delta libsvn_subr apriconv apr ruby swig
-link-cmd = $(LINK) $(SWIG_RB_LIBS)
+link-cmd = $(LINK_LIB) $(SWIG_RB_LIBS)
 install = swig-rb-lib
 # need special build rule to include
 compile-cmd = $(COMPILE_SWIG_RB)
@@ -769,6 +769,7 @@ install = test
 libs = libsvn_repos libsvn_fs libsvn_delta libsvn_subr aprutil apriconv apr
 msvc-static = yes
 undefined-lib-symbols = yes
+link-cmd = $(LINK_TEST_LIB)
 
 # ----------------------------------------------------------------------------
 # Tests for libsvn_fs_base
diff -uap subversion-1.12.0.pie/Makefile.in subversion-1.12.0/Makefile.in
--- subversion-1.12.0/Makefile.in.pie	2019-01-22 08:55:54.000000000 -0500
+++ subversion-1.12.0/Makefile.in	2019-05-03 13:57:49.546984251 -0400
@@ -268,10 +268,14 @@ TEST_SHLIB_VAR_SWIG_RB=\
 COMPILE_SVNXX = $(LT_COMPILE_CXX) $(SVNXX_INCLUDES) -o $@ -c
 COMPILE_SVNXX_TEST = $(LT_COMPILE_CXX) $(SVNXX_INCLUDES) $(BOOST_TEST_CPPFLAGS) -o $@ -c
 
-LINK = $(LIBTOOL) $(LTFLAGS) --mode=link $(CC) $(LT_LDFLAGS) $(CFLAGS) $(LDFLAGS) -rpath $(libdir)
-LINK_LIB = $(LINK) $(LT_SO_VERSION)
-LINK_CXX = $(LIBTOOL) $(LTCXXFLAGS) --mode=link $(CXX) $(LT_LDFLAGS) $(CXXFLAGS) $(LDFLAGS) -rpath $(libdir)
-LINK_CXX_LIB = $(LINK_CXX) $(LT_SO_VERSION)
+LINK = $(LIBTOOL) $(LTFLAGS) --mode=link $(CC) $(LT_LDFLAGS) $(CFLAGS) $(LDFLAGS)
+LINK_LIB = $(LINK) $(LT_SO_VERSION) -rpath $(libdir)
+LINK_CXX = $(LIBTOOL) $(LTCXXFLAGS) --mode=link $(CXX) $(LT_LDFLAGS) $(CXXFLAGS) $(LDFLAGS)
+LINK_CXX_LIB = $(LINK_CXX) $(LT_SO_VERSION) -rpath $(libdir)
+LINK_TEST = $(LINK) -no-install
+LINK_TEST_LIB = $(LINK) -avoid-version
+LINK_TEST_CXX_LIB = $(LINK_CXX) -avoid-version
+LINK_CXX_EXE = $(LINK) -pie
 LINK_SVNXX_TEST = $(LINK_CXX) $(BOOST_TEST_LDFLAGS)
 
 # special link rule for mod_dav_svn
@@ -793,10 +797,10 @@ schema-clean:
 	$(PYTHON) $(top_srcdir)/build/transform_sql.py $< $(top_srcdir)/$@
 
 .c.o:
-	$(COMPILE) -o $@ -c $<
+	$(COMPILE) -fPIE -o $@ -c $<
 
 .cpp.o:
-	$(COMPILE_CXX) -o $@ -c $<
+	$(COMPILE_CXX) -fPIE -o $@ -c $<
 
 .c.lo:
 	$(LT_COMPILE) -o $@ -c $<
